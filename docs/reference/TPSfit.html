<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="TPSfit() is used to fit multidimensional tensor product splines to
longitudinal data with three or more variable of interest prior to
implementation of a clustering algorithm."><title>Fit tensor product splines to longitudinal data — TPSfit • TPSClus</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit tensor product splines to longitudinal data — TPSfit"><meta property="og:description" content="TPSfit() is used to fit multidimensional tensor product splines to
longitudinal data with three or more variable of interest prior to
implementation of a clustering algorithm."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">TPSClus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/demo.html">Clustering Multivariate Longitudinal Data using Tensor Product Smoothing Splines</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit tensor product splines to longitudinal data</h1>
      
      <div class="d-none name"><code>TPSfit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>TPSfit()</code> is used to fit multidimensional tensor product splines to
longitudinal data with three or more variable of interest prior to
implementation of a clustering algorithm.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">TPSfit</span><span class="op">(</span><span class="va">data</span>, <span class="va">time</span>, <span class="va">vars</span>, <span class="va">ID</span>, <span class="va">knots_time</span>, <span class="va">kt</span>, <span class="va">fit_times</span>, <span class="va">n_fit_times</span>, st <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A longitudinal dataset in long form with multiple variables
measured over time.</p></dd>


<dt>time</dt>
<dd><p>Name of the time variable (e.g. "Time").</p></dd>


<dt>vars</dt>
<dd><p>A character vector of at least 3 variables of interest.</p></dd>


<dt>ID</dt>
<dd><p>Name of the subject ID variable.</p></dd>


<dt>knots_time</dt>
<dd><p>A numeric vector of knots for spline-fitting the time
variable. Must supply knots_time or kt.</p></dd>


<dt>kt</dt>
<dd><p>Number of evenly spaced knots for spline-fitting the time variable
if knots_time is not given.</p></dd>


<dt>fit_times</dt>
<dd><p>Optional vector for times where fitted values will be
calculated. If fit_times and n_fit_times are not given, fitted values are
calculated at knots.</p></dd>


<dt>n_fit_times</dt>
<dd><p>Number of evenly spaced times where fitted values will be
calculated if fit_times are not given.</p></dd>


<dt>st</dt>
<dd><p>Logical expression indicating whether each variable should be
standardized.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class '<code>TPSfit</code>' containing the following components: <br></p>


<ul><li><p><code>GAMsfitted</code> A data frame containing the fitted spline values. <br></p></li>
<li><p><code>GAMscoef</code> A data frame containing the tensor product spline coefficients <br></p></li>
<li><p><code>data_long</code> A data frame containing data in long format for both time and
variable <br></p></li>
<li><p><code>knots</code> A list of two vectors containing the variable and time knots <br></p></li>
<li><p><code>indiv_means</code> A list containing a data frame of individual means for each of
the variables of interest <br></p></li>
<li><p><code>GAMs</code> A list containing the generalized additive models for fitting splines
on each individual <br></p></li>
<li><p><code>nsubject</code> The number of subjects in the dataset <br></p></li>
<li><p><code>IDmatch</code> A data frame matching the original subject ID and new consecutive
ID numbers <br></p></li>
<li><p><code>error_subjects</code> A vector of individuals that encountered errors in the
spline-fitting process <br></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>TPSfit()</code> employs package <code>mgcv</code> to fit a tensor product splines to each
individual using a generalized additive model. The fitted splines are
two-dimensional, with one dimension being the variable identifier and the
other being time. An adequate number of observed time points are required for
each individual, and the number of knots should be less than the smallest
number of time points. If splines are unable to be fit for an individual, an
error message will be shown, but splines will be fit for remaining
individuals. A vector of identifiers for individuals with errors is included
in the output as <code>error_subjects</code>, and these subjects are not included in the
output <code>GAMSsfitted</code> or <code>GAMscoef</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The <code>mgcv</code> R package: <a href="https://cran.r-project.org/web/packages/mgcv/index.html" class="external-link">https://cran.r-project.org/web/packages/mgcv/index.html</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>; <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>; <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">TS.sim</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fitsplines</span> <span class="op">&lt;-</span> <span class="fu">TPSfit</span><span class="op">(</span><span class="va">TS.sim</span>, vars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Var1"</span>, <span class="st">"Var2"</span>, <span class="st">"Var3"</span><span class="op">)</span>, time<span class="op">=</span><span class="st">"Time"</span>,</span></span>
<span class="r-in"><span>     ID<span class="op">=</span><span class="st">"SubjectID"</span>, knots_time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">91</span>, <span class="fl">182</span>, <span class="fl">273</span>, <span class="fl">365</span><span class="op">)</span>, n_fit_times<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fitsplines2</span> <span class="op">&lt;-</span> <span class="fu">TPSfit</span><span class="op">(</span><span class="va">TS.sim</span>, vars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Var1"</span>, <span class="st">"Var2"</span>, <span class="st">"Var3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>time<span class="op">=</span><span class="st">"Time"</span>, ID<span class="op">=</span><span class="st">"SubjectID"</span>, knots_time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">91</span>, <span class="fl">182</span>, <span class="fl">273</span>, <span class="fl">365</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     fit_times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">46</span>, <span class="fl">91</span>, <span class="fl">137</span>, <span class="fl">182</span>, <span class="fl">228</span>, <span class="fl">273</span>, <span class="fl">319</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Sherry Livingston.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

