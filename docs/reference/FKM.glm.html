<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="FKM.glm() fits a generalized linear model (GLM) using clusters output from
cluster.fitted() or cluster.coefs() as predictors, along with additional covariates."><title>Fit a generalized linear model (GLM) using clusters a predictors — FKM.glm • TPSClus</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a generalized linear model (GLM) using clusters a predictors — FKM.glm"><meta property="og:description" content="FKM.glm() fits a generalized linear model (GLM) using clusters output from
cluster.fitted() or cluster.coefs() as predictors, along with additional covariates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">TPSClus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/demo.html">Clustering Multivariate Longitudinal Data using Tensor Product Smoothing Splines</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit a generalized linear model (GLM) using clusters a predictors</h1>
      
      <div class="d-none name"><code>FKM.glm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>FKM.glm()</code> fits a generalized linear model (GLM) using clusters output from
<code><a href="cluster.fitted.html">cluster.fitted()</a></code> or <code><a href="cluster.coefs.html">cluster.coefs()</a></code> as predictors, along with additional covariates.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">FKM.glm</span><span class="op">(</span><span class="va">FKM_object</span>, <span class="va">data</span>, <span class="va">y</span>, <span class="va">covariates</span>, refclus <span class="op">=</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>FKM_object</dt>
<dd><p>An object of class <code>FKM.TPS</code> output from <code><a href="cluster.fitted.html">cluster.fitted()</a></code>
or <code><a href="cluster.coefs.html">cluster.coefs()</a></code>.</p></dd>


<dt>data</dt>
<dd><p>A data frame with the same subjects used for spline-fitting and
clustering that includes an outcome variable of interest and optional
covariates.</p></dd>


<dt>y</dt>
<dd><p>Name of the outcome variable (e.g. <code>y="Death"</code>)</p></dd>


<dt>covariates</dt>
<dd><p>A vector of covariates of interest to be included in the
model.</p></dd>


<dt>refclus</dt>
<dd><p>Numeric identification of the cluster to be used as the
reference cluster. Default is cluster 1 (<code>refclus=1</code>). Use <code>refclus=0</code> to
identify the noise cluster as the reference cluster.</p></dd>


<dt>family</dt>
<dd><p>A description of the error distribution and link function to be
used in the model.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments for the <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>FKM.glm</code> containing the following components:</p><ul><li><p><code>FKM_object</code> The inputted object of class <code>FKM.TPS</code>.</p></li>
<li><p><code>model_data</code> A data frame containing the variables used in the model, including degree of cluster membership.</p></li>
<li><p><code>formula</code> The formula used in the model.</p></li>
<li><p><code>family</code> The family call used in the model.</p></li>
<li><p><code>model_full</code> The GLM model using clusters as predictors and any additional
covariates of interest.</p></li>
<li><p><code>model_noclusters</code> The GLM model using the covariates of interest but no
clusters.</p></li>
<li><p><code>anova</code> ANOVA comparing the models with and without clusters as predictors.</p></li>
<li><p><code>anova_pval</code> P-value for the ANOVA comparing the models with and without
clusters as predictors.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>FKM.glm()</code> applies the <code>glm</code> function to fit a generalized linear model
using clusters as predictors. Clusters are obtained using <code><a href="cluster.fitted.html">cluster.fitted()</a></code>
or <code><a href="cluster.coefs.html">cluster.coefs()</a></code>, and the output object of class <code>FKM.TPS</code> is input into
the <code>FKM.glm()</code> function, along with a dataset containing the output variable
and additional covariates of interest. Clusters are included using the
"partial assignment" method that employs the degree of cluster membership for
each individual to account for uncertainty in the cluster assignment.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The glm function: <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>; <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>; <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span>; <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">fclust</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: nlme</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: 'nlme'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from 'package:dplyr':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     collapse</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This is mgcv 1.8-36. For overview type 'help("mgcv-package")'.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">TS.sim</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fitsplines</span> <span class="op">&lt;-</span> <span class="fu"><a href="TPSfit.html">TPSfit</a></span><span class="op">(</span><span class="va">TS.sim</span>, vars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Var1"</span>, <span class="st">"Var2"</span>, <span class="st">"Var3"</span><span class="op">)</span>, time<span class="op">=</span><span class="st">"Time"</span>,</span></span>
<span class="r-in"><span>     ID<span class="op">=</span><span class="st">"SubjectID"</span>, knots_time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">91</span>, <span class="fl">182</span>, <span class="fl">273</span>, <span class="fl">365</span><span class="op">)</span>, n_fit_times<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">clusters1</span> <span class="op">&lt;-</span> <span class="fu"><a href="cluster.fitted.html">cluster.fitted</a></span><span class="op">(</span><span class="va">fitsplines</span>, k<span class="op">=</span><span class="fl">3</span>, m<span class="op">=</span><span class="fl">1.3</span>, seed<span class="op">=</span><span class="fl">12345</span>, RS<span class="op">=</span><span class="fl">5</span>, noise<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">FKM.glm</span><span class="op">(</span><span class="va">clusters1</span>, <span class="va">TS.sim</span>, y<span class="op">=</span><span class="st">"outcome"</span>, covariates<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>family<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula (f1):  outcome ~ Clus2 + Clus3 + Noise + x1 + x2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: binomial </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glm(formula = f1, family = family, data = data3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deviance Residuals: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min        1Q    Median        3Q       Max  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.98641  -0.22509  -0.02046   0.14030   2.13265  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 12.91873    2.58402   4.999 5.75e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clus2       -2.51549    1.00954  -2.492   0.0127 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clus3       -1.27507    0.82022  -1.555   0.1201    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Noise        0.99726    1.59330   0.626   0.5314    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1           0.78247    0.68891   1.136   0.2560    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2          -0.28124    0.05409  -5.200 1.99e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Dispersion parameter for binomial family taken to be 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Null deviance: 201.065  on 149  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance:  63.197  on 144  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 75.197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations: 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ANOVA chi-square p-value for significance of clusters in model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.02512377</span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="va">anova_pval</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.02512377</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Sherry Livingston.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

